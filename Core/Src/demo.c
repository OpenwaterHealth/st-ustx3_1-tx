/*
 * demo.c
 *
 *  Created on: Feb 12, 2024
 *      Author: gvigelet
 */
#include "demo.h"
#include "main.h"
#include <stdio.h>

unsigned int reg_values[][2] = {
        {0x00, 0x00000000},
        {0x01, 0x00000000},
        {0x06, 0x00000000},
        {0x0B, 0x00000000},
        {0x0C, 0x00000000},
        {0x0F, 0x00000000},
        {0x14, 0x00000000},
        {0x15, 0x00000000},
        {0x16, 0x00000000},
        {0x17, 0x00000000},
        {0x18, 0x02000003},
        {0x19, 0x00000744},
        {0x1A, 0x00000000},
        {0x1B, 0x00000000},
        {0x1E, 0x00000000},
        {0x1F, 0x00000000},
        {0x20, 0x1FFF1770},
        {0x21, 0x1FFF1770},
        {0x22, 0x0E1004B0},
        {0x23, 0x0E1004B0},
        {0x24, 0x1C2012C0},
        {0x25, 0x1C2012C0},
        {0x26, 0x09600000},
        {0x27, 0x09600000},
        {0x28, 0x1FFF1770},
        {0x29, 0x1FFF1770},
        {0x2A, 0x0E1004B0},
        {0x2B, 0x0E1004B0},
        {0x2C, 0x1C2012C0},
        {0x2D, 0x1C2012C0},
        {0x2E, 0x09600000},
        {0x2F, 0x09600000},
        {0x120, 0xF1F2F2F2},
        {0x121, 0x0007F1F1},
    };

unsigned int reg_1mhz_3p_values[][2] = {
	    // GLOBAL
		{0x00,0x00000000},
		{0x01,0x00000000},
	    {0x06,0x00000000},
	    {0x0B,0x00000000},
	    {0x0C,0x00000000},
	    {0x0F,0x00000000},
	    {0x14,0x00000000},
	    {0x15,0x00000000},
	    {0x16,0x00000000},
	    {0x17,0x00000000},
	    {0x18,0x02000003},
	    {0x19,0x00000744},
	    // CHANNEL-PDN
	    {0x1A,0x00000000},
	    {0x1B,0x00000000},
	    // PATTERN-SELECT
	    {0x1E,0x00000000},
	    {0x1F,0x00000000},
	    // DELAY-PROFILE
	    {0x20,0x1FFF1770},
	    {0x21,0x1FFF1770},
	    {0x22,0x0E1004B0},
	    {0x23,0x0E1004B0},
	    {0x24,0x1C2012C0},
	    {0x25,0x1C2012C0},
	    {0x26,0x09600000},
	    {0x27,0x09600000},
	    {0x28,0x1FFF1770},
	    {0x29,0x1FFF1770},
	    {0x2A,0x0E1004B0},
	    {0x2B,0x0E1004B0},
	    {0x2C,0x1C2012C0},
	    {0x2D,0x1C2012C0},
	    {0x2E,0x09600000},
	    {0x2F,0x09600000},
	    {0x30,0x00000000},
	    {0x31,0x00000000},
	    {0x32,0x00000000},
	    {0x33,0x00000000},
	    {0x34,0x00000000},
	    {0x35,0x00000000},
	    {0x36,0x00000000},
	    {0x37,0x00000000},
	    {0x38,0x00000000},
	    {0x39,0x00000000},
	    {0x3A,0x00000000},
	    {0x3B,0x00000000},
	    {0x3C,0x00000000},
	    {0x3D,0x00000000},
	    {0x3E,0x00000000},
	    {0x3F,0x00000000},
	    {0x40,0x00000000},
	    {0x41,0x00000000},
	    {0x42,0x00000000},
	    {0x43,0x00000000},
	    {0x44,0x00000000},
	    {0x45,0x00000000},
	    {0x46,0x00000000},
	    {0x47,0x00000000},
	    {0x48,0x00000000},
	    {0x49,0x00000000},
	    {0x4A,0x00000000},
	    {0x4B,0x00000000},
	    {0x4C,0x00000000},
	    {0x4D,0x00000000},
	    {0x4E,0x00000000},
	    {0x4F,0x00000000},
	    {0x50,0x00000000},
	    {0x51,0x00000000},
	    {0x52,0x00000000},
	    {0x53,0x00000000},
	    {0x54,0x00000000},
	    {0x55,0x00000000},
	    {0x56,0x00000000},
	    {0x57,0x00000000},
	    {0x58,0x00000000},
	    {0x59,0x00000000},
	    {0x5A,0x00000000},
	    {0x5B,0x00000000},
	    {0x5C,0x00000000},
	    {0x5D,0x00000000},
	    {0x5E,0x00000000},
	    {0x5F,0x00000000},
	    {0x60,0x00000000},
	    {0x61,0x00000000},
	    {0x62,0x00000000},
	    {0x63,0x00000000},
	    {0x64,0x00000000},
	    {0x65,0x00000000},
	    {0x66,0x00000000},
	    {0x67,0x00000000},
	    {0x68,0x00000000},
	    {0x69,0x00000000},
	    {0x6A,0x00000000},
	    {0x6B,0x00000000},
	    {0x6C,0x00000000},
	    {0x6D,0x00000000},
	    {0x6E,0x00000000},
	    {0x6F,0x00000000},
	    {0x70,0x00000000},
	    {0x71,0x00000000},
	    {0x72,0x00000000},
	    {0x73,0x00000000},
	    {0x74,0x00000000},
	    {0x75,0x00000000},
	    {0x76,0x00000000},
	    {0x77,0x00000000},
	    {0x78,0x00000000},
	    {0x79,0x00000000},
	    {0x7A,0x00000000},
	    {0x7B,0x00000000},
	    {0x7C,0x00000000},
	    {0x7D,0x00000000},
	    {0x7E,0x00000000},
	    {0x7F,0x00000000},
	    {0x80,0x00000000},
	    {0x81,0x00000000},
	    {0x82,0x00000000},
	    {0x83,0x00000000},
	    {0x84,0x00000000},
	    {0x85,0x00000000},
	    {0x86,0x00000000},
	    {0x87,0x00000000},
	    {0x88,0x00000000},
	    {0x89,0x00000000},
	    {0x8A,0x00000000},
	    {0x8B,0x00000000},
	    {0x8C,0x00000000},
	    {0x8D,0x00000000},
	    {0x8E,0x00000000},
	    {0x8F,0x00000000},
	    {0x90,0x00000000},
	    {0x91,0x00000000},
	    {0x92,0x00000000},
	    {0x93,0x00000000},
	    {0x94,0x00000000},
	    {0x95,0x00000000},
	    {0x96,0x00000000},
	    {0x97,0x00000000},
	    {0x98,0x00000000},
	    {0x99,0x00000000},
	    {0x9A,0x00000000},
	    {0x9B,0x00000000},
	    {0x9C,0x00000000},
	    {0x9D,0x00000000},
	    {0x9E,0x00000000},
	    {0x9F,0x00000000},
	    {0xA0,0x00000000},
	    {0xA1,0x00000000},
	    {0xA2,0x00000000},
	    {0xA3,0x00000000},
	    {0xA4,0x00000000},
	    {0xA5,0x00000000},
	    {0xA6,0x00000000},
	    {0xA7,0x00000000},
	    {0xA8,0x00000000},
	    {0xA9,0x00000000},
	    {0xAA,0x00000000},
	    {0xAB,0x00000000},
	    {0xAC,0x00000000},
	    {0xAD,0x00000000},
	    {0xAE,0x00000000},
	    {0xAF,0x00000000},
	    {0xB0,0x00000000},
	    {0xB1,0x00000000},
	    {0xB2,0x00000000},
	    {0xB3,0x00000000},
	    {0xB4,0x00000000},
	    {0xB5,0x00000000},
	    {0xB6,0x00000000},
	    {0xB7,0x00000000},
	    {0xB8,0x00000000},
	    {0x27,0x00000000},
	    {0xBA,0x00000000},
	    {0xBB,0x00000000},
	    {0xBC,0x00000000},
	    {0xBD,0x00000000},
	    {0xBE,0x00000000},
	    {0xBF,0x00000000},
	    {0xC0,0x00000000},
	    {0xC1,0x00000000},
	    {0xC2,0x00000000},
	    {0xC3,0x00000000},
	    {0xC4,0x00000000},
	    {0xC5,0x00000000},
	    {0xC6,0x00000000},
	    {0xC7,0x00000000},
	    {0xC8,0x00000000},
	    {0xC9,0x00000000},
	    {0xCA,0x00000000},
	    {0xCB,0x00000000},
	    {0xCC,0x00000000},
	    {0xCD,0x00000000},
	    {0xCE,0x00000000},
	    {0xCF,0x00000000},
	    {0xD0,0x00000000},
	    {0xD1,0x00000000},
	    {0xD2,0x00000000},
	    {0xD3,0x00000000},
	    {0xD4,0x00000000},
	    {0xD5,0x00000000},
	    {0xD6,0x00000000},
	    {0xD7,0x00000000},
	    {0xD8,0x00000000},
	    {0xD9,0x00000000},
	    {0xDA,0x00000000},
	    {0xDB,0x00000000},
	    {0xDC,0x00000000},
	    {0xDD,0x00000000},
	    {0xDE,0x00000000},
	    {0xDF,0x00000000},
	    {0xE0,0x00000000},
	    {0xE1,0x00000000},
	    {0xE2,0x00000000},
	    {0xE3,0x00000000},
	    {0xE4,0x00000000},
	    {0xE5,0x00000000},
	    {0xE6,0x00000000},
	    {0xE7,0x00000000},
	    {0xE8,0x00000000},
	    {0xE9,0x00000000},
	    {0xEA,0x00000000},
	    {0xEB,0x00000000},
	    {0xEC,0x00000000},
	    {0xED,0x00000000},
	    {0xEE,0x00000000},
	    {0xEF,0x00000000},
	    {0xF0,0x00000000},
	    {0xF1,0x00000000},
	    {0xF2,0x00000000},
	    {0xF3,0x00000000},
	    {0xF4,0x00000000},
	    {0xF5,0x00000000},
	    {0xF6,0x00000000},
	    {0xF7,0x00000000},
	    {0xF8,0x00000000},
	    {0xF9,0x00000000},
	    {0xFA,0x00000000},
	    {0xFB,0x00000000},
	    {0xFC,0x00000000},
	    {0xFD,0x00000000},
	    {0xFE,0x00000000},
	    {0xFF,0x00000000},
	    {0x100,0x00000000},
	    {0x101,0x00000000},
	    {0x102,0x00000000},
	    {0x103,0x00000000},
	    {0x104,0x00000000},
	    {0x105,0x00000000},
	    {0x106,0x00000000},
	    {0x107,0x00000000},
	    {0x108,0x00000000},
	    {0x109,0x00000000},
	    {0x10A,0x00000000},
	    {0x10B,0x00000000},
	    {0x10C,0x00000000},
	    {0x10D,0x00000000},
	    {0x10E,0x00000000},
	    {0x10F,0x00000000},
	    {0x110,0x00000000},
	    {0x111,0x00000000},
	    {0x112,0x00000000},
	    {0x113,0x00000000},
	    {0x114,0x00000000},
	    {0x115,0x00000000},
	    {0x116,0x00000000},
	    {0x117,0x00000000},
	    {0x118,0x00000000},
	    {0x119,0x00000000},
	    {0x11A,0x00000000},
	    {0x11B,0x00000000},
	    {0x11C,0x00000000},
	    {0x11D,0x00000000},
	    {0x11E,0x00000000},
	    {0x11F,0x00000000},
	    // PATTERN-PROFILE
	    {0x120,0xF1F2F2F2},
	    {0x121,0x0007F1F1},
	    {0x122,0x00000000},
	    {0x123,0x00000000},
	    {0x124,0x00000000},
	    {0x125,0x00000000},
	    {0x126,0x00000000},
	    {0x127,0x00000000},
	    {0x128,0x00000000},
	    {0x129,0x00000000},
	    {0x12A,0x00000000},
	    {0x12B,0x00000000},
	    {0x12C,0x00000000},
	    {0x12D,0x00000000},
	    {0x12E,0x00000000},
	    {0x12F,0x00000000},
	    {0x130,0x00000000},
	    {0x131,0x00000000},
	    {0x132,0x00000000},
	    {0x133,0x00000000},
	    {0x134,0x00000000},
	    {0x135,0x00000000},
	    {0x136,0x00000000},
	    {0x137,0x00000000},
	    {0x138,0x00000000},
	    {0x139,0x00000000},
	    {0x13A,0x00000000},
	    {0x13B,0x00000000},
	    {0x13C,0x00000000},
	    {0x13D,0x00000000},
	    {0x13E,0x00000000},
	    {0x13F,0x00000000},
	    {0x140,0x00000000},
	    {0x141,0x00000000},
	    {0x142,0x00000000},
	    {0x143,0x00000000},
	    {0x144,0x00000000},
	    {0x145,0x00000000},
	    {0x146,0x00000000},
	    {0x147,0x00000000},
	    {0x148,0x00000000},
	    {0x149,0x00000000},
	    {0x14A,0x00000000},
	    {0x14B,0x00000000},
	    {0x14C,0x00000000},
	    {0x14D,0x00000000},
	    {0x14E,0x00000000},
	    {0x14F,0x00000000},
	    {0x150,0x00000000},
	    {0x151,0x00000000},
	    {0x152,0x00000000},
	    {0x153,0x00000000},
	    {0x154,0x00000000},
	    {0x155,0x00000000},
	    {0x156,0x00000000},
	    {0x157,0x00000000},
	    {0x158,0x00000000},
	    {0x159,0x00000000},
	    {0x15A,0x00000000},
	    {0x15B,0x00000000},
	    {0x15C,0x00000000},
	    {0x15D,0x00000000},
	    {0x15E,0x00000000},
	    {0x15F,0x00000000},
	    {0x160,0x00000000},
	    {0x161,0x00000000},
	    {0x162,0x00000000},
	    {0x163,0x00000000},
	    {0x164,0x00000000},
	    {0x165,0x00000000},
	    {0x166,0x00000000},
	    {0x167,0x00000000},
	    {0x168,0x00000000},
	    {0x169,0x00000000},
	    {0x16A,0x00000000},
	    {0x16B,0x00000000},
	    {0x16C,0x00000000},
	    {0x16D,0x00000000},
	    {0x16E,0x00000000},
	    {0x16F,0x00000000},
	    {0x170,0x00000000},
	    {0x171,0x00000000},
	    {0x172,0x00000000},
	    {0x173,0x00000000},
	    {0x174,0x00000000},
	    {0x175,0x00000000},
	    {0x176,0x00000000},
	    {0x177,0x00000000},
	    {0x178,0x00000000},
	    {0x179,0x00000000},
	    {0x17A,0x00000000},
	    {0x17B,0x00000000},
	    {0x17C,0x00000000},
	    {0x17D,0x00000000},
	    {0x17E,0x00000000},
	    {0x17F,0x00000000},
	    {0x180,0x00000000},
	    {0x181,0x00000000},
	    {0x182,0x00000000},
	    {0x183,0x00000000},
	    {0x184,0x00000000},
	    {0x185,0x00000000},
	    {0x186,0x00000000},
	    {0x187,0x00000000},
	    {0x188,0x00000000},
	    {0x189,0x00000000},
	    {0x18A,0x00000000},
	    {0x18B,0x00000000},
	    {0x18C,0x00000000},
	    {0x18D,0x00000000},
	    {0x18E,0x00000000},
	    {0x18F,0x00000000},
	    {0x190,0x00000000},
	    {0x191,0x00000000},
	    {0x192,0x00000000},
	    {0x193,0x00000000},
	    {0x194,0x00000000},
	    {0x195,0x00000000},
	    {0x196,0x00000000},
	    {0x197,0x00000000},
	    {0x198,0x00000000},
	    {0x199,0x00000000},
	    {0x19A,0x00000000},
	    {0x19B,0x00000000},
	    {0x19C,0x00000000},
	    {0x19D,0x00000000},
	    {0x19E,0x00000000},
	    {0x19F,0x00000000}
};


void write_demo_registers(TX7332* pT)
{
	int num_registers = sizeof(reg_values) / sizeof(reg_values[0]);
	for (int i = 0; i < num_registers; i++) {
        unsigned int reg_address = reg_values[i][0];
        unsigned int expected_value = reg_values[i][1];
		TX7332_WriteReg(pT, reg_address, expected_value);
	}
}

bool verify_demo_registers(TX7332* pT)
{
	int bSuccess = true;
	int num_registers = sizeof(reg_values) / sizeof(reg_values[0]);
	for (int i = 0; i < num_registers; i++) {
        unsigned int reg_address = reg_values[i][0];
        unsigned int expected_value = reg_values[i][1];
        unsigned int actual_value = TX7332_ReadReg(pT, reg_address);

        if (actual_value != expected_value) {
            //printf("==> Mismatch at index 0x%04X: 0x%08X, 0x%08X\r\n", (uint16_t)reg_address, actual_value, expected_value);
        	bSuccess = false;
        }else{
            //printf("Match at index 0x%04X: 0x%08X, 0x%08X\r\n", (uint16_t)reg_address, actual_value, expected_value);
        }
	}
	return bSuccess;
}

void write_test_pattern_registers(TX7332* pT)
{
	int num_registers = sizeof(reg_1mhz_3p_values) / sizeof(reg_1mhz_3p_values[0]);
	for (int i = 0; i < num_registers; i++) {
        unsigned int reg_address = reg_1mhz_3p_values[i][0];
        unsigned int expected_value = reg_1mhz_3p_values[i][1];
		TX7332_WriteReg(pT, reg_address, expected_value);
	}
}

int verify_test_pattern_registers(TX7332* pT)
{
	int bSuccess = 1;
	int num_registers = sizeof(reg_1mhz_3p_values) / sizeof(reg_1mhz_3p_values[0]);
	for (int i = 0; i < num_registers; i++) {
        unsigned int reg_address = reg_1mhz_3p_values[i][0];
        unsigned int expected_value = reg_1mhz_3p_values[i][1];
        unsigned int actual_value = TX7332_ReadReg(pT, reg_address);

        if (actual_value != expected_value) {
            //printf("==> Mismatch at index 0x%04X: 0x%08X, 0x%08X\r\n", (uint16_t)reg_address, actual_value, expected_value);
        	bSuccess = 0;
        }else{
            //printf("Match at index 0x%04X: 0x%08X, 0x%08X\r\n", (uint16_t)reg_address, actual_value, expected_value);
        }
	}
	return bSuccess;
}
